\documentclass[journal]{IEEEtran}
\usepackage{cite}
\usepackage{amsmath}
\usepackage{algorithmic}
\usepackage{array}

% *** SUBFIGURE PACKAGES ***
\ifCLASSOPTIONcompsoc
 \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
\else
 \usepackage[caption=false,font=footnotesize]{subfig}
\fi

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}
\title{A survey on vision transformer}

\author{Yuhuan Yang,~\IEEEmembership{MedianBrainGroup,STJU,}}

\maketitle

\begin{abstract}
The abstract goes here.
\end{abstract}

\begin{IEEEkeywords}
IEEE, IEEEtran, journal, \LaTeX, paper, template.
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle

\section{Introduction\cite{w}}
Active contour model, also called snakes, is a framework in computer vision introduced by Michael Kass, Andrew Witkin, and Demetri Terzopoulos\cite{snake} for delineating an object outline from a possibly noisy 2D image. The snakes model is popular in computer vision, and snakes are widely used in applications like object tracking, shape recognition, segmentation, edge detection and stereo matching.

A snake is an energy minimizing, deformable spline influenced by constraint and image forces that pull it towards object contours and internal forces that resist deformation. Snakes may be understood as a special case of the general technique of matching a deformable model to an image by means of energy minimization.\cite{snake} In two dimensions, the active shape model represents a discrete version of this approach, taking advantage of the point distribution model to restrict the shape range to an explicit domain learnt from a training set.

Snakes do not solve the entire problem of finding contours in images, since the method requires knowledge of the desired contour shape beforehand. Rather, they depend on other mechanisms such as interaction with a user, interaction with some higher level image understanding process, or information from image data adjacent in time or space.

\section{Snakes model}
The snake model was first introduced in 1988 by Kass\cite{snake}. The basic idea of this paper is define snake model as a \textit{controlled continuity}\cite{s18} spline under the influence of image forces and external constraint forces. Representing the position of a snake parametrically by $\mathbf{v}(s)=(x(s),y(s))$, the energy function of snake model can be written as:
\begin{equation}\begin{aligned}
E_{\text{snake}}=&\int_0^1 E_{\text{snake}}(\mathbf{v}(s))ds\\
=&\int_0^1 E_{\text{int}}(\mathbf{v}(s))+E_{\text{image}}(\mathbf{v}(s))\\
&+E_{\text{con}}(\mathbf{v}(s))ds,\label{eq1}
\end{aligned}\end{equation}
where $E_{\text{int}}$ represents the internal energy of the spline due to bending, $E_{\text{image}}$ gives rise to the image forces, and $E_{\text{con}}$ represents the external constraint forces. In the following section, we introduce all of the three energy in detail.
\subsection{Internal Energy}
The internal spline energy can be written as:
\begin{equation}\begin{aligned}
E_{\text{int}}=(\alpha(s)\|\mathbf{v}'(s)\|^2+\beta(s)\|\mathbf{v}''(s)\|^2).
\end{aligned}\end{equation}
The internal part of spline energy is composed of a first-order term comtrolled by $\alpha(s)$ and a second-order term controlled by $\beta(s)$. The first-order term makes the snake act like a membrane, and the second-order term makes it act like a thing plate. By adjusting the weight of $\alpha(s)$ and $\beta(s)$, we can control the relative importance of the membrane and thin-plate terms.
\subsection{Detailed minimizing procedure}
When $\alpha(s)$ and $\beta(s)$ are constants, minimizing the energy function\ref{eq1} gives rise to the following two independent Euler equations:
\begin{equation}\begin{aligned}
\alpha x''+\beta x''''+\frac{\partial E_{\text{ext}}}{\partial x}=0\\
\alpha y''+\beta y''''+\frac{\partial E_{\text{ext}}}{\partial x}=0
\end{aligned}\end{equation} 
When $\alpha(s)$ and $\beta(s)$ are not constant, is's simpler to go directly to a discrete formulation as:
\begin{equation}\begin{aligned}
E_{\text{snake}}=\sum_{i=1}^n E_{\text{int}}(i)+E_{\text{ext}}(i)
\end{aligned}\end{equation}
Approximating the derivatives with finite differences and converting to vector notation with $\mathbf{v}_i=(x_i,y_i)=(x(ih),y(ih))$, we have:
\begin{equation}\begin{aligned}
E_{\text{int}}(i)=&\alpha_i |\mathbf{v}_i-\mathbf{v}_{i-1}|^2/2h^2\\
&+\beta_i|\mathbf{v}_{i-1}-2\mathbf{v}_i+\mathbf{v}_{i+1}|^2/2h^4.
\end{aligned}\end{equation}
Let $f_x(i)=\frac{\partial E_{\text{ext}}}{\partial x_i}$ and $f_y(i)=\frac{\partial E_{\text{ext}}}{\partial y_i}$, the corresponding Euler equation becomes:
\begin{equation}\begin{aligned}
    \alpha_{i}\left(\mathbf{v}_{i}-\mathbf{v}_{i-1}\right)&- \alpha_{i+1}\left(\mathbf{v}_{i+1}-\mathbf{v}_{i}\right) \\
    &+\beta_{i-1}\left[\mathbf{v}_{i-2}-2 \mathbf{v}_{i-1}+\mathbf{v}_{i}\right] \\
    &-2 \beta_{i}\left[\mathbf{v}_{i-1}-2 \mathbf{v}_{i}+\mathbf{v}_{i+1}\right] \\
    &+\beta_{i+1}\left[\mathbf{v}_{i}-2 \mathbf{v}_{i+1}+\mathbf{v}_{i+2}\right] \\
    &+\left(f_{x}(i), f_{y}(i)\right)=0
\end{aligned}\end{equation}
The above Euler equations can be written in matrix form as:
\begin{equation}\begin{aligned}
\mathbf{Ax+f_x(x,y)}=0\\
\mathbf{Ay+f_y(x,y)}=0 \label{eq2}
\end{aligned}\end{equation}
where $A$ is a pentadiagonal banded matrix.

The equation \ref{eq2} can be rewrite in the format of time derivative as:
\begin{equation}\begin{aligned}
  \mathbf{Ax_t+f_x(x_{t-1},y_{t-1})}=-\gamma(\mathbf{x_t-x_{t-1}})\\
  \mathbf{Ay_t+f_y(x_{t-1},y_{t-1})}=-\gamma(\mathbf{y_t-y_{t-1}}) \label{eq3}
\end{aligned}\end{equation}
and the equation \ref{eq3} can be soved by matrix inversion:
\begin{equation}\begin{aligned}
\mathbf{x_t}=(\mathbf{A}+\gamma\mathbf{I})^{-1}(\mathbf{x_{t-1}-f_x(x_{t-1},y_{t-1})})\\
\mathbf{y_t}=(\mathbf{A}+\gamma\mathbf{I})^{-1}(\mathbf{y_{t-1}-f_y(x_{t-1},y_{t-1})})\label{eq5}
\end{aligned}\end{equation}

\section{Introduction}

\IEEEPARstart{T}{his} demo file is intended to serve as a ``starter file''
for IEEE journal papers produced under \LaTeX\ using
IEEEtran.cls version 1.8b and later.

\subsection{Subsection Heading Here}
Subsection text here.

\subsubsection{Subsubsection Heading Here}
Subsubsection text here.


%\begin{figure}[!t]
%\centering
%\includegraphics[width=2.5in]{myfigure}
%\caption{Simulation results for the network.}
%\label{fig_sim}
%\end{figure}

%\begin{figure*}[!t]
%\centering
%\subfloat[Case I]{\includegraphics[width=2.5in]{box}%
%\label{fig_first_case}}
%\hfil
%\subfloat[Case II]{\includegraphics[width=2.5in]{box}%
%\label{fig_second_case}}
%\caption{Simulation results for the network.}
%\label{fig_sim}
%\end{figure*}
%

\begin{table}[!t]
%% increase table row spacing, adjust to taste
\renewcommand{\arraystretch}{1.3}
% if using array.sty, it might be a good idea to tweak the value of
% \extrarowheight as needed to properly center the text within the cells
\caption{An Example of a Table}
\label{table_example}
\centering
%% Some packages, such as MDW tools, offer better commands for making tables
%% than the plain LaTeX2e tabular which is used here.
\begin{tabular}{|c||c|}
\hline
One & Two\\
\hline
Three & Four\\
\hline
\end{tabular}
\end{table}
\subsection{Image forces}
In order to make snakes useful for early vision we need energy functions that attract them to salient features in image. Generally, the image energy functions should attract a snake to lines, edges, and terminations. The total image energy can be expressed as a weighted combination of the three terms:
\begin{equation}\begin{aligned}
E_{\text{image}}=w_{\text{line}}E_{\text{line}}+w_{\text{edge}}E_{\text{edge}}+w_{\text{term}}E_{\text{term}}.
\end{aligned}\end{equation}
Now we introduce some simple but useful image energy terms.
\subsubsection{Line function}
The simplest useful image function is the image intensity it self. If we set
\begin{equation}\begin{aligned}
E_{\text{line}}=I(x,y),
\end{aligned}\end{equation}
then, depending on the sign of $w_{\text{line}}$, the snake will be attracted either to light lines or dark lines.
\subsubsection{Edge function}
Finding edges in an image can also be done with a very simple energy function by just setting:
\begin{equation}\begin{aligned}
E_{\text{edge}}=-|\nabla I(x,y)|^2.\label{eq4}
\end{aligned}\end{equation}
With this function, the snake will be attracted to contours with large image gradients.
\subsubsection{Scale space}
One can allow the snake to come to equilibrium on a very blurry energy function and then slowly reduce the blurring. The result is minimization by scale-continuation.\cite{s20},\cite{s21} Thus, a new format of edge energy function is developed as:
\begin{equation}\begin{aligned}
E_{\text{line}}=-(G_\sigma * \nabla^2I)^2,
\end{aligned}\end{equation}
where $G_\sigma$ is a Gaussian of standard deviation $\sigma$.
\subsubsection{Termination function}
In order to find terminations of line segments and corners, we use the curvature of level lines in a slightly smoothed image. Let $C(x,y)=G_\sigma(x,y)*I(x,y)$ be a slightly smoothed version of the image, let $\theta=\tan^{-1}{(C_y/C_x)}$ be the gradient angle and let $\mathbf{n}=(\cos \theta,\sin\theta),\mathbf{n}_\perp=(-\sin\theta,\cos\theta)$, the curvature of level contours in $C(x,y)$ can be written as:
\begin{equation}\begin{aligned}
    E_{\mathrm{tem}} &=\frac{\partial \theta}{\partial \mathbf{n}_{\perp}} \\
    &=\frac{\partial^{2} C / \partial \mathbf{n}_{\perp}^{2}}{\partial C / \partial \mathbf{n}} \\
    &=\frac{C_{y y} C_{x}^{2}-2 C_{x y} C_{x} C_{y}+C_{x x} C_{y}^{2}}{\left(C_{x}^{2}+C_{y}^{2}\right)^{3 / 2}}
\end{aligned}\end{equation}

\section{Conclusion}
The conclusion goes here.\cite{han2020survey}

% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi

% references section
\bibliographystyle{IEEEtran}
\bibliography{IEEEabrv,../bib/paper}

\end{document}


